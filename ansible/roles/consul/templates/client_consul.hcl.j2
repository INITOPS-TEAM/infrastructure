node_name  = "{{ inventory_hostname }}"
server     = false
datacenter = "{{ consul_datacenter }}"
data_dir   = "{{ consul_data_dir }}"

bind_addr      = "{{ ansible_facts['eth1']['ipv4']['address'] }}"
client_addr    = "0.0.0.0"
advertise_addr = "{{ ansible_facts['eth1']['ipv4']['address'] }}"

retry_join = ["{{ consul_server_ip }}"]

encrypt = "{{ consul_gossip_key }}"

tls {
  defaults {
    ca_file   = "{{ consul_config_dir }}/certs/consul-agent-ca.pem"
    cert_file = "{{ consul_config_dir }}/certs/client.pem"
    key_file  = "{{ consul_config_dir }}/certs/client-key.pem"

    verify_incoming = true
    verify_outgoing = true
  }
}

ports {
  http  = -1
  https = 8501
  dns   = 8600
}

log_level = "INFO"